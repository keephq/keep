workflow:
  id: query-victoriametrics
  name: victoriametrics
  description: victoriametrics
  triggers:
    - type: manual
  steps:
    - name: victoriametrics-step
      provider:
        config: "{{ providers.victoriametrics }}"
        type: victoriametrics
        with:
          query: avg(rate(process_cpu_seconds_total))
          queryType: query

  actions:
    - name: ntfy-action
      provider:
        config: "{{ providers.ntfy }}"
        type: ntfy
        with:
          message: "Result: {{ steps.victoriametrics-step.results.data.result }}"
          topic: victoriametrics

    - name: slack-action
      provider:
        config: "{{ providers.slack }}"
        type: slack
        with:
          message: "Result: {{ steps.victoriametrics-step.results.data.result }}"