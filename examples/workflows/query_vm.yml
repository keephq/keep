workflow:
  id: query-victoriametrics
  name: vm
  description: victoriametrics
  triggers:
    - type: manual
  steps:
    - name: victoriametrics-step
      provider:
        config: "{{ providers.vm }}"
        type: victoriametrics
        with:
          query: avg(rate(process_cpu_seconds_total))
          queryType: query

  actions:
    - name: trigger-console
      condition:
        - name: threshold-condition
          type: threshold
          value: "{{ steps.victoriametrics-step.results.data.result.0.value.1 }}"
          compare_to: 0.0050
          alias: A
          operator: ">"
      provider:
        type: console
        with:
          message: "Result: {{ steps.victoriametrics-step.results.data.result.0.value.1 }} is greater than 0.0040! ðŸš¨"
