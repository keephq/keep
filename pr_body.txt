This PR addresses critical database connection issues under high load as described in #5496.

### Changes:
1.  **Fixed Deferred Loader Failure**: Added `session.refresh(deduplication_event)` in `create_deduplication_event` to ensure the `id` is populated before it's accessed for logging.
2.  **Prevented 'Idle in Transaction'**: Added a SQLAlchemy checkout listener to perform a `rollback()` on connection checkout. This ensures connections are returned to the pool in a clean state and prevents sessions from being stuck in 'idle in transaction' state, which is a major cause of pool exhaustion.
3.  **Optimized SQLite Performance**: Enabled WAL (Write-Ahead Logging) and Normal synchronous mode for SQLite to improve concurrency and performance in local/dev environments.

These changes significantly improve the reliability of the connection pool both with direct PostgreSQL connections and when using PgBouncer.

Fixes #5496